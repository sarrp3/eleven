<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Will You Be My Valentine? ‚ù§Ô∏è - Sarp & Elvin</title>
    
    <!-- Load Transformers.js for REAL AI understanding -->
    <script src="https://cdn.jsdelivr.net/npm/@xenova/transformers@2.6.0"></script>
    
    <!-- Load your chat history -->
    <script src="chats.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            transition: background 0.3s;
            padding: 20px;
        }
        
        .container {
            background: rgba(255, 255, 255, 0.95);
            padding: 2rem;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            max-width: 1000px;
            width: 100%;
            margin: 20px;
        }
        
        h1 {
            color: #ff4d6d;
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }
        
        .locked-content {
            position: relative;
            filter: blur(8px);
            pointer-events: none;
            opacity: 0.6;
            transition: all 0.5s;
        }
        
        .locked-content.unlocked {
            filter: blur(0);
            pointer-events: all;
            opacity: 1;
        }
        
        .lock-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 77, 109, 0.9);
            color: white;
            padding: 30px;
            border-radius: 20px;
            z-index: 10;
            font-size: 1.5rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            backdrop-filter: blur(5px);
            border: 2px solid white;
            transition: all 0.5s;
            pointer-events: none;
        }
        
        .lock-overlay.hidden {
            opacity: 0;
            visibility: hidden;
        }
        
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .tab-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 50px;
            background: #f0f0f0;
            color: #333;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }
        
        .tab-btn.active {
            background: #ff4d6d;
            color: white;
        }
        
        .tab-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255,77,109,0.3);
        }
        
        .tab-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .tab-content {
            display: none;
            min-height: 500px;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .valentine-section {
            padding: 20px;
        }
        
        .question {
            font-size: 2rem;
            color: #333;
            margin-bottom: 2rem;
            font-weight: bold;
        }
        
        .buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 15px 40px;
            font-size: 1.5rem;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
            font-weight: bold;
        }
        
        .btn:hover {
            transform: scale(1.1);
        }
        
        .yes-btn {
            background: #ff4d6d;
            color: white;
        }
        
        .no-btn {
            background: #666;
            color: white;
        }
        
        .message {
            margin-top: 30px;
            font-size: 1.2rem;
            color: #ff4d6d;
            min-height: 60px;
            font-weight: bold;
        }
        
        .chat-container {
            background: #f9f9f9;
            border-radius: 15px;
            padding: 20px;
            height: 600px;
            display: flex;
            flex-direction: column;
        }
        
        .chat-messages {
            flex-grow: 1;
            overflow-y: auto;
            padding: 15px;
            background: white;
            border-radius: 10px;
            margin-bottom: 15px;
            text-align: left;
        }
        
        .chat-message {
            margin-bottom: 15px;
            padding: 12px;
            border-radius: 10px;
            background: #f0f0f0;
            max-width: 90%;
            word-wrap: break-word;
        }
        
        .chat-message.sent {
            background: #ff4d6d;
            color: white;
            margin-left: auto;
        }
        
        .chat-message .sender {
            font-weight: bold;
            margin-bottom: 5px;
            font-size: 0.9rem;
            color: #ff4d6d;
        }
        
        .chat-message.sent .sender {
            color: #ffe6e9;
        }
        
        .chat-message .time {
            font-size: 0.7rem;
            opacity: 0.7;
            margin-top: 5px;
        }
        
        .chat-stats {
            background: #fff0f2;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            font-size: 0.9rem;
        }
        
        .ai-section {
            background: #f9f9f9;
            border-radius: 15px;
            padding: 20px;
        }
        
        .ai-status {
            background: #ff4d6d;
            color: white;
            padding: 10px;
            border-radius: 50px;
            margin-bottom: 20px;
            font-size: 0.9rem;
            display: inline-block;
            padding: 8px 20px;
        }
        
        .ai-input {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .ai-input input {
            flex-grow: 1;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 50px;
            font-size: 1rem;
        }
        
        .ai-input button {
            padding: 12px 24px;
            background: #ff4d6d;
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .ai-input button:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(255,77,109,0.4);
        }
        
        .ai-input button:disabled {
            opacity: 0.5;
            cursor: wait;
        }
        
        .ai-response {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: left;
            min-height: 200px;
            border: 2px solid #ffe6e9;
            overflow-y: auto;
            max-height: 400px;
            white-space: pre-wrap;
            line-height: 1.6;
            font-size: 1rem;
        }
        
        .chat-filter {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        
        .filter-btn {
            padding: 8px 16px;
            border: 1px solid #ff4d6d;
            background: white;
            color: #ff4d6d;
            border-radius: 50px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s;
        }
        
        .filter-btn.active {
            background: #ff4d6d;
            color: white;
        }
        
        .filter-btn:hover {
            background: #ff4d6d;
            color: white;
        }
        
        .love-quote {
            background: #ffe6e9;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            font-style: italic;
            color: #ff4d6d;
        }
        
        .model-loading {
            background: #fff3cd;
            color: #856404;
            padding: 10px;
            border-radius: 10px;
            margin-bottom: 15px;
            font-size: 0.9rem;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .loading {
            animation: pulse 1.5s infinite;
        }
        
        @media (max-width: 600px) {
            .container {
                padding: 1rem;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .question {
                font-size: 1.5rem;
            }
            
            .btn {
                padding: 12px 30px;
                font-size: 1.2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>‚ù§Ô∏è Sarp & Elvin ‚ù§Ô∏è</h1>
        
        <!-- Main Valentine Question - Always Visible -->
        <div class="valentine-section" style="margin-bottom: 30px;">
            <div class="question" id="questionText">
                Switzerland? No...<br>
                Will YOU be my Valentine? üíï
            </div>
            
            <div class="buttons">
                <button class="btn yes-btn" id="yesBtn" onclick="sayYes()">YES! ‚ù§Ô∏è</button>
                <button class="btn no-btn" id="noBtn" onclick="sayNo()">No</button>
            </div>
            
            <div class="message" id="message"></div>
        </div>
        
        <!-- Locked Content - Only Unlocks After YES -->
        <div id="lockedContent" class="locked-content">
            <div id="lockOverlay" class="lock-overlay">
                üíï Say YES to unlock our memories! üíï
            </div>
            
            <div class="tabs">
                <button class="tab-btn" id="chatTabBtn" onclick="switchTab('chats')" disabled>üí¨ Our 2,500+ Chats</button>
                <button class="tab-btn" id="aiTabBtn" onclick="switchTab('ai')" disabled>ü§ñ AI That Knows Us</button>
            </div>
            
            <!-- Chats Tab -->
            <div id="chats-tab" class="tab-content">
                <div class="chat-container">
                    <div class="chat-stats" id="chatStats">
                        üíó Loading your beautiful conversations...
                    </div>
                    <div class="chat-filter">
                        <button class="filter-btn" onclick="filterChats('all')" disabled>üí¨ All</button>
                        <button class="filter-btn" onclick="filterChats('Elvin')" disabled>üíó Elvin</button>
                        <button class="filter-btn" onclick="filterChats('Sarp')" disabled>üíô Sarp</button>
                        <button class="filter-btn" onclick="filterChats('‚ù§Ô∏è')" disabled>‚ù§Ô∏è Love</button>
                        <button class="filter-btn" onclick="filterChats('switzerland')" disabled>üá®üá≠ Switzerland</button>
                    </div>
                    <div id="chatMessages" class="chat-messages">
                        <!-- Chats will be loaded here -->
                    </div>
                </div>
            </div>
            
            <!-- AI Tab -->
            <div id="ai-tab" class="tab-content">
                <div class="ai-section">
                    <h3 style="color: #ff4d6d; margin-bottom: 10px;">ü§ñ Our Personal AI</h3>
                    <div id="aiStatus" class="ai-status loading">
                        ‚è≥ Loading AI model... Please wait (first time takes 30 seconds)
                    </div>
                    <div class="love-quote" id="aiWelcomeQuote">
                        This AI has read all 2,500+ of our messages. Ask it anything about us! üíï
                    </div>
                    <div class="ai-input">
                        <input type="text" id="aiQuestion" placeholder="Ask anything... (e.g., 'When did we first talk?', 'Tell me about Switzerland')" disabled>
                        <button id="aiAskBtn" onclick="askAI()" disabled>Ask ‚ù§Ô∏è</button>
                    </div>
                    <div id="aiResponse" class="ai-response">
                        ‚ú® Say YES to unlock our personal AI that understands our love story! ‚ú®
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ============ CONFIGURATION ============
        const WEBHOOK_URL = 'https://discord.com/api/webhooks/1471208266070757592/gGJGKrE7iC5p4-Qgy-QXb9x5Wu5qJN_7R8rr9WODrpTHX3ADRgH2-8Rq_nKbusmo1YA2';
        
        // Global variables
        let noClickCount = 0;
        let userIP = '';
        let currentChatFilter = 'all';
        let isUnlocked = false;
        let pipeline = null;
        let isModelLoading = false;
        
        // ============ CHECK CHAT HISTORY IS LOADED ============
        if (typeof chatHistory === 'undefined') {
            console.error('‚ùå chats.js not loaded! Make sure the file exists and is loaded before this HTML.');
            // Create empty array as fallback
            var chatHistory = [];
        } else {
            console.log(`‚úÖ Loaded ${chatHistory.length} messages from chats.js`);
        }
        
        // ============ VALENTINE FUNCTIONS ============
        window.onload = function() {
            checkBanStatus();
            createHearts();
            
            // Pre-load chat stats but keep locked
            if (chatHistory.length > 0) {
                updateChatStats();
            }
        };
        
        function sayYes() {
            // Unlock everything!
            isUnlocked = true;
            
            // Hide lock overlay
            document.getElementById('lockOverlay').classList.add('hidden');
            document.getElementById('lockedContent').classList.add('unlocked');
            
            // Enable all buttons
            document.querySelectorAll('.tab-btn, .filter-btn, #aiQuestion, #aiAskBtn').forEach(btn => {
                btn.disabled = false;
            });
            
            // Update UI
            document.getElementById('questionText').innerHTML = 'YAY! You said YES! ‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è';
            document.getElementById('message').innerHTML = '3 months, 2500+ messages, and now this... You make me the happiest person ever! ü•∞';
            document.getElementById('noBtn').style.display = 'none';
            
            const yesBtn = document.getElementById('yesBtn');
            yesBtn.style.transform = 'scale(1.2)';
            yesBtn.innerHTML = 'YES! ‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è';
            
            // Load chats and AI
            loadChats();
            initializeAI();
            
            // Send to Discord
            sendToDiscord('‚úÖ **ELVIN SAID YES!** ‚úÖ\n‚ù§Ô∏è Happy Valentine\'s Day! ‚ù§Ô∏è\nIP: ' + userIP + '\nTime: ' + new Date().toLocaleString());
            
            // Celebration hearts
            for(let i = 0; i < 100; i++) {
                setTimeout(createHeart, i * 20);
            }
        }
        
        function sayNo() {
            noClickCount++;
            
            let message = '';
            let noButtonText = 'No';
            
            switch(noClickCount) {
                case 1:
                    message = 'Are you sure? üò¢';
                    noButtonText = 'No...';
                    break;
                case 2:
                    message = 'Are you really really sure? üíî';
                    noButtonText = 'Still no...';
                    break;
                case 3:
                    message = 'Last chance... Please? ü•∫';
                    noButtonText = '...no';
                    break;
                default:
                    banUser();
                    return;
            }
            
            document.getElementById('message').innerHTML = message;
            document.getElementById('noBtn').innerHTML = noButtonText;
            
            const yesBtn = document.getElementById('yesBtn');
            yesBtn.style.transform = `scale(${1 + (noClickCount * 0.2)})`;
            
            const noBtn = document.getElementById('noBtn');
            noBtn.style.transform = `translateX(${Math.random() * 20 - 10}px) translateY(${Math.random() * 20 - 10}px)`;
            
            sendToDiscord('üò¢ **SHE CLICKED NO (' + noClickCount + '/3)**\nMessage: "' + message + '"\nIP: ' + userIP + '\nTime: ' + new Date().toLocaleString());
            createSadHeart();
        }
        
        // ============ CHAT FUNCTIONS ============
        function switchTab(tabName) {
            if (!isUnlocked) return;
            
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            document.getElementById(`${tabName}-tab`).classList.add('active');
            event.target.classList.add('active');
            
            if (tabName === 'chats') {
                loadChats();
            }
        }
        
        function loadChats() {
            if (!isUnlocked || chatHistory.length === 0) {
                document.getElementById('chatMessages').innerHTML = '<div style="text-align: center; padding: 50px; color: #999;">üíï No messages loaded yet. Check that chats.js exists! üíï</div>';
                return;
            }
            
            const chatContainer = document.getElementById('chatMessages');
            chatContainer.innerHTML = '';
            
            let filteredChats = chatHistory;
            if (currentChatFilter !== 'all') {
                if (currentChatFilter === '‚ù§Ô∏è') {
                    filteredChats = chatHistory.filter(chat => 
                        chat.text.includes('‚ù§Ô∏è') || 
                        chat.text.includes('love') || 
                        chat.text.includes('sevi') ||
                        chat.text.includes('üíï') ||
                        chat.text.includes('üíó')
                    );
                } else if (currentChatFilter === 'switzerland') {
                    filteredChats = chatHistory.filter(chat => 
                        chat.text.toLowerCase().includes('switzerland') || 
                        chat.text.toLowerCase().includes('isvi√ßre')
                    );
                } else {
                    filteredChats = chatHistory.filter(chat => chat.sender === currentChatFilter);
                }
            }
            
            // Show last 100 messages (most recent first)
            const messagesToShow = filteredChats.slice(-100).reverse();
            
            messagesToShow.forEach(chat => {
                const messageDiv = document.createElement('div');
                messageDiv.className = `chat-message ${chat.type === 'sent' ? 'sent' : ''}`;
                
                const senderDiv = document.createElement('div');
                senderDiv.className = 'sender';
                senderDiv.textContent = chat.sender;
                
                const textDiv = document.createElement('div');
                textDiv.textContent = chat.text;
                
                const timeDiv = document.createElement('div');
                timeDiv.className = 'time';
                timeDiv.textContent = chat.time;
                
                messageDiv.appendChild(senderDiv);
                messageDiv.appendChild(textDiv);
                messageDiv.appendChild(timeDiv);
                
                chatContainer.appendChild(messageDiv);
            });
            
            updateChatStats();
        }
        
        function updateChatStats() {
            const elvinMsgs = chatHistory.filter(c => c.sender === 'Elvin').length;
            const sarpMsgs = chatHistory.filter(c => c.sender === 'Sarp').length;
            const loveMsgs = chatHistory.filter(c => c.text.includes('‚ù§Ô∏è') || c.text.includes('love') || c.text.includes('sevi')).length;
            
            document.getElementById('chatStats').innerHTML = `
                <span>üí¨ Total: ${chatHistory.length} messages</span>
                <span>üíó Elvin: ${elvinMsgs}</span>
                <span>üíô Sarp: ${sarpMsgs}</span>
                <span>‚ù§Ô∏è Love: ${loveMsgs}</span>
                <span>üìÖ Since: March 2025</span>
            `;
        }
        
        function filterChats(filter) {
            if (!isUnlocked) return;
            currentChatFilter = filter;
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            loadChats();
        }
        
        // ============ REAL AI WITH TRANSFORMERS.JS ============
        async function initializeAI() {
            if (!isUnlocked) return;
            if (pipeline) return;
            if (isModelLoading) return;
            
            isModelLoading = true;
            
            const statusEl = document.getElementById('aiStatus');
            const quoteEl = document.getElementById('aiWelcomeQuote');
            const responseEl = document.getElementById('aiResponse');
            const inputEl = document.getElementById('aiQuestion');
            const askBtn = document.getElementById('aiAskBtn');
            
            statusEl.innerHTML = '‚è≥ Loading AI model (Xenova/tiny-random-llama)... This takes 30 seconds first time! ‚è≥';
            statusEl.className = 'ai-status loading';
            responseEl.innerHTML = 'üß† Loading our personal AI that understands our love story...\n\nThis will only happen once! After it loads, you can ask me anything about Sarp and Elvin üíï';
            
            try {
                // Use a tiny but capable model for understanding
                statusEl.innerHTML = '‚è≥ Downloading AI (2MB)... This is a one-time download! ‚è≥';
                
                // Create a question-answering pipeline
                pipeline = await transformers.pipeline('text-generation', 'Xenova/tiny-random-llama');
                
                statusEl.innerHTML = '‚úÖ AI is ready! Ask me anything about your conversations with Sarp! üíï';
                statusEl.className = 'ai-status';
                quoteEl.innerHTML = '‚ú® I\'ve read all 2,500+ messages. What do you want to know about your love story? ‚ú®';
                responseEl.innerHTML = 'üíï Hi Elvin! I\'m your personal AI that understands your conversations with Sarp.\n\nYou can ask me things like:\n‚Ä¢ "When did we first talk about Switzerland?"\n‚Ä¢ "Show me love messages from July"\n‚Ä¢ "What did Sarp say when we became official?"\n‚Ä¢ "Tell me about the night of July 4"\n‚Ä¢ "Find messages where Sarp called me beautiful"\n\nWhat would you like to know? üíï';
                
                inputEl.disabled = false;
                askBtn.disabled = false;
                
            } catch (error) {
                console.error('Failed to load AI model:', error);
                statusEl.innerHTML = '‚ö†Ô∏è AI model failed to load. Using smart search instead! ‚ö†Ô∏è';
                statusEl.className = 'ai-status';
                responseEl.innerHTML = '‚ùå Couldn\'t load the AI model, but I can still search our messages!\n\nTry asking specific questions and I\'ll find relevant messages from our chat history üíï';
                
                // Enable input anyway
                inputEl.disabled = false;
                askBtn.disabled = false;
                pipeline = 'fallback'; // Use fallback mode
            }
            
            isModelLoading = false;
        }
        
        async function askAI() {
            if (!isUnlocked) return;
            
            const question = document.getElementById('aiQuestion').value;
            if (!question.trim()) return;
            
            const responseEl = document.getElementById('aiResponse');
            const askBtn = document.getElementById('aiAskBtn');
            
            responseEl.innerHTML = 'üí≠ Thinking... üí≠';
            askBtn.disabled = true;
            
            try {
                let answer = '';
                
                if (pipeline && pipeline !== 'fallback') {
                    // Use REAL AI model
                    const context = generateContextFromChats(question);
                    
                    const prompt = `You are an AI that knows everything about Sarp and Elvin's relationship. Based on these chat messages, answer the question.\n\nChat history context:\n${context}\n\nQuestion: ${question}\n\nAnswer in a warm, loving way. Be specific about dates and messages if relevant.`;
                    
                    const result = await pipeline(prompt, {
                        max_new_tokens: 150,
                        temperature: 0.7,
                        do_sample: true,
                    });
                    
                    answer = result[0].generated_text.replace(prompt, '').trim();
                    
                } else {
                    // Fallback to smart search
                    answer = smartSearch(question);
                }
                
                responseEl.innerHTML = answer;
                sendToDiscord(`ü§ñ **AI Question from Elvin**\nQ: "${question}"\nA: "${answer.substring(0, 200)}..."\nTime: ${new Date().toLocaleString()}`);
                
            } catch (error) {
                console.error('AI Error:', error);
                responseEl.innerHTML = '‚ùå Sorry, I had trouble answering that. Try asking something else!\n\n' + smartSearch(question);
            }
            
            askBtn.disabled = false;
        }
        
        function generateContextFromChats(question) {
            // Find relevant messages based on the question
            const words = question.toLowerCase().split(' ');
            let relevant = [];
            
            // Keywords to search for
            const keywords = [
                'switzerland', 'isvi√ßre', 'first', 'ilk', 'love', 'a≈ük', 'sevi',
                'official', 'july', 'temmuz', 'night', 'gece', 'confess', 'a√ßƒ±l',
                'beautiful', 'g√ºzel', 'cute', 'tatlƒ±', 'kiss', '√∂p', 'sarƒ±l',
                'heart', 'kalp', 'date', 'bulu≈ü', '√ßamlƒ±k', 'avm'
            ];
            
            keywords.forEach(keyword => {
                if (question.toLowerCase().includes(keyword)) {
                    const matches = chatHistory.filter(c => 
                        c.text.toLowerCase().includes(keyword)
                    ).slice(-5);
                    relevant = [...relevant, ...matches];
                }
            });
            
            if (relevant.length === 0) {
                // Get most important messages
                relevant = chatHistory.filter(c => 
                    c.text.includes('‚ù§Ô∏è') || 
                    c.text.includes('love you') ||
                    c.time.includes('2025-07-04')
                ).slice(-10);
            }
            
            return relevant.slice(0, 10).map(c => 
                `[${c.time}] ${c.sender}: ${c.text}`
            ).join('\n');
        }
        
        function smartSearch(question) {
            const q = question.toLowerCase();
            
            // Switzerland questions
            if (q.includes('switzerland') || q.includes('isvi√ßre')) {
                const swissMsgs = chatHistory.filter(c => 
                    c.text.toLowerCase().includes('switzerland') || 
                    c.text.toLowerCase().includes('isvi√ßre')
                );
                let response = `üá®üá≠ **Switzerland Search Results**\n\nFound ${swissMsgs.length} messages about Switzerland.\n\n`;
                response += swissMsgs.slice(-5).map(c => 
                    `‚Ä¢ ${c.sender} (${c.time}): "${c.text}"`
                ).join('\n');
                return response;
            }
            
            // When we became official
            if (q.includes('official') || q.includes('july 4') || q.includes('4 temmuz') || q.includes('became')) {
                const july4 = chatHistory.filter(c => 
                    c.time.includes('2025-07-04') && 
                    (c.text.includes('love') || c.text.includes('sevi') || c.text.includes('‚ù§Ô∏è'))
                );
                let response = `üíï **The Night We Became Official - July 4, 2025** üíï\n\n`;
                response += july4.slice(-8).map(c => 
                    `‚Ä¢ ${c.sender} (${c.time}): "${c.text}"`
                ).join('\n');
                response += `\n\n‚ú® This was the night everything changed. From Switzerland to "I love you" ‚ú®`;
                return response;
            }
            
            // Love messages
            if (q.includes('love') || q.includes('a≈ük') || q.includes('sevi')) {
                const loveMsgs = chatHistory.filter(c => 
                    c.text.includes('‚ù§Ô∏è') || 
                    c.text.includes('love you') || 
                    c.text.includes('seviyorum')
                );
                let response = `‚ù§Ô∏è **Messages of Love** ‚ù§Ô∏è\n\n`;
                response += loveMsgs.slice(-10).map(c => 
                    `‚Ä¢ ${c.sender} (${c.time}): "${c.text}"`
                ).join('\n');
                return response;
            }
            
            // General stats
            if (q.includes('how many') || q.includes('count') || q.includes('stat')) {
                const elvinMsgs = chatHistory.filter(c => c.sender === 'Elvin').length;
                const sarpMsgs = chatHistory.filter(c => c.sender === 'Sarp').length;
                const loveMsgs = chatHistory.filter(c => c.text.includes('‚ù§Ô∏è')).length;
                
                return `üìä **Our Chat Statistics** üìä\n\n` +
                       `‚Ä¢ Total messages: ${chatHistory.length}\n` +
                       `‚Ä¢ Elvin: ${elvinMsgs} messages\n` +
                       `‚Ä¢ Sarp: ${sarpMsgs} messages\n` +
                       `‚Ä¢ ‚ù§Ô∏è Hearts sent: ${loveMsgs}\n` +
                       `‚Ä¢ First message: March 2, 2025\n` +
                       `‚Ä¢ Official: July 4, 2025 (3 AM!)\n` +
                       `‚Ä¢ Days together: ${Math.floor((new Date() - new Date('2025-07-04')) / (1000*60*60*24))} days\n` +
                       `‚Ä¢ Status: ‚ù§Ô∏è HAPPILY IN LOVE ‚ù§Ô∏è`;
            }
            
            // Default response
            return `üíï **I found these messages for you:** üíï\n\n${
                chatHistory.slice(-5).map(c => 
                    `‚Ä¢ ${c.sender} (${c.time}): "${c.text}"`
                ).join('\n')
            }\n\n‚ú® Ask me about Switzerland, July 4th, love messages, or our statistics! ‚ú®`;
        }
        
        // ============ UTILITY FUNCTIONS ============
        function checkBanStatus() {
            fetch('https://api.ipify.org?format=json')
                .then(response => response.json())
                .then(data => {
                    userIP = data.ip;
                    const bannedIPs = JSON.parse(localStorage.getItem('bannedIPs') || '[]');
                    if (bannedIPs.includes(userIP)) {
                        banUser();
                    }
                })
                .catch(error => console.error('Error getting IP:', error));
        }
        
        function banUser() {
            sendToDiscord('üö´ **IP BANNED!** üö´\nShe clicked NO 4 times!\nIP: ' + userIP + '\nTime: ' + new Date().toLocaleString());
            
            const bannedIPs = JSON.parse(localStorage.getItem('bannedIPs') || '[]');
            if (!bannedIPs.includes(userIP)) {
                bannedIPs.push(userIP);
                localStorage.setItem('bannedIPs', JSON.stringify(bannedIPs));
            }
            
            document.body.classList.add('banned');
            document.querySelector('.container').innerHTML = `
                <h1 style="color: #ff0000; font-size: 4rem;">üö´</h1>
                <div style="color: #ff0000; font-size: 2rem; margin: 20px 0;" class="banned-message">
                    ACCESS DENIED
                </div>
                <div style="color: #666; font-size: 1.2rem;">
                    You had your chance...<br>
                    üíî<br>
                    IP: ${userIP}<br>
                    Banned: ${new Date().toLocaleString()}
                </div>
            `;
        }
        
        function sendToDiscord(content) {
            fetch(WEBHOOK_URL, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    content: content,
                    username: 'Valentine Site',
                    avatar_url: 'https://cdn-icons-png.flaticon.com/512/210/210545.png'
                })
            }).catch(error => console.error('Error sending to Discord:', error));
        }
        
        function createHearts() {
            setInterval(() => {
                if (!document.body.classList.contains('banned')) {
                    createHeart();
                }
            }, 300);
        }
        
        function createHeart() {
            const heart = document.createElement('div');
            heart.innerHTML = '‚ù§Ô∏è';
            heart.style.position = 'fixed';
            heart.style.left = Math.random() * 100 + '%';
            heart.style.top = '100%';
            heart.style.fontSize = Math.random() * 30 + 20 + 'px';
            heart.style.opacity = Math.random() * 0.5 + 0.5;
            heart.style.animation = 'floatUp ' + (Math.random() * 3 + 2) + 's linear forwards';
            heart.style.pointerEvents = 'none';
            heart.style.zIndex = '9999';
            document.body.appendChild(heart);
            setTimeout(() => heart.remove(), 5000);
        }
        
        function createSadHeart() {
            const heart = document.createElement('div');
            heart.innerHTML = 'üíî';
            heart.style.position = 'fixed';
            heart.style.left = Math.random() * 100 + '%';
            heart.style.top = '100%';
            heart.style.fontSize = Math.random() * 30 + 20 + 'px';
            heart.style.opacity = 0.7;
            heart.style.animation = 'floatUp ' + (Math.random() * 3 + 2) + 's linear forwards';
            heart.style.pointerEvents = 'none';
            heart.style.zIndex = '9999';
            document.body.appendChild(heart);
            setTimeout(() => heart.remove(), 5000);
        }
    </script>
    
    <style>
        @keyframes floatUp {
            0% { transform: translateY(0) rotate(0deg); opacity: 0.8; }
            100% { transform: translateY(-100vh) rotate(360deg); opacity: 0; }
        }
        
        .banned {
            background: #1a1a1a !important;
        }
        
        .banned-message {
            animation: glitch 1s infinite;
        }
        
        @keyframes glitch {
            0%, 100% { transform: skew(0deg); }
            20% { transform: skew(10deg); }
            40% { transform: skew(-10deg); }
            60% { transform: skew(5deg); }
            80% { transform: skew(-5deg); }
        }
        
        .locked-content {
            position: relative;
        }
    </style>
</body>
</html>
